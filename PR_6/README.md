# Практика 006
Arikova Kristina
2024-11-18

## Использование технологии Yandex Query для анализа данных сетевой активности

## Цель

1.  Изучить возможности технологии Yandex Query для анализа
    структурированных наборов данных

2.  Получить навыки построения аналитического пайплайна для анализа
    данных с помощью сервисов Yandex Cloud

3.  Закрепить практические навыки использования SQL для анализа данных
    сетевой активности в сегментированной корпоративной сети

## Исходные данные

-   Компьютер

-   ОС Windows

-   Яндекс Браузер

-   Сервисы Yandex Cloud, Yandex Query

## Общий план выполнения

1.  Используя сервис Yandex Query настроить доступ к данным, хранящимся
    в сервисе хранения данных Yandex Object Storage
2.  Настроить подключение к Yandex Query из DataLens
3.  Создать из запроса Yandex Query датасет DataLens
4.  Решение аналитических задач

## Содержание ЛР

### Шаг 1. Настройка Yandex Query и подключение данных в Yandex Object Storage

Настройка и подключение к общей организации Yandex Query выполенена на
основе методичкеских указаний и представлена в [отчете по практической
работе
№4](https://github.com/gigwrld/Threat_Hunt_Arikova/tree/main/PR_4).

### Шаг 2. Настроить подключение к Yandex Query из DataLens

Создано и настроено новое подключение датасета к Yandex Query из
DataLens.

<figure>
<img src="images/Подключение.png" data-fig-align="center"
alt="Новое подключение" />
<figcaption aria-hidden="true">Новое подключение</figcaption>
</figure>

### Шаг 3. Создать из запроса Yandex Query датасет DataLens

Создан датасет для дальнейшего анализа данных.

<figure>
<img src="images/Датасет.png" data-fig-align="center"
alt="Содержимое датасета" />
<figcaption aria-hidden="true">Содержимое датасета</figcaption>
</figure>

### Шаг 4. Решение аналитических задач

1.  Представлено в виде круговой диаграммы соотношение внешнего и
    внутреннего сетевого трафик

    <figure>
    <img src="images/Сетевой%20трафик.png" alt="Сетевой трафик" />
    <figcaption aria-hidden="true">Сетевой трафик</figcaption>
    </figure>

    В параметре ЦВЕТ представлена следующая функция на языке SQL:

    `IF (([dst] LIKE '12.%' OR [dst] LIKE '13.%' OR [dst] LIKE '14.%') AND ([src] LIKE '12.%' OR [src] LIKE '13.%' OR [src] LIKE '14.%')) THEN "Внутренний трафик" ELSE "Внешний трафик" END`

    В параметре ПОКАЗАТЕЛИ и ПОДПИСИ представлено количество байт
    передаваемого трафика.

2.  Представлено в виде столбчатой диаграммы соотношение входящего и
    исходящего трафика из внутреннего сетвого сегмента.

    <figure>
    <img src="images/Трафик%20внутренней%20сети.png"
    alt="Трафик внутренней сети" />
    <figcaption aria-hidden="true">Трафик внутренней сети</figcaption>
    </figure>

    В качетве параметров Y и ПОДПИСИ выбрано количество байт
    передаваемоего трафика, а в качетве пареметров X и ЦВЕТА
    представлена следующая функция на языке SQL:

    `IF (([src] LIKE '12.%' OR [src] LIKE '13.%' OR [src] LIKE '14.%') AND (NOT([dst] LIKE '12.%' OR [dst] LIKE '13.%' OR [dst] LIKE '14.%'))) THEN "Исходящий трафик" ELSEIF (([dst] LIKE '12.%' OR [dst] LIKE '13.%' OR [dst] LIKE '14.%') AND (NOT([src] LIKE '12.%' OR [src] LIKE '13.%' OR [src] LIKE '14.%'))) THEN "Входящий трафик" END`

3.  Построен график активности (линейная диаграмма) объема трафика во
    времени.

    <figure>
    <img src="images/Активность%20трафика.png" alt="Активность трафика" />
    <figcaption aria-hidden="true">Активность трафика</figcaption>
    </figure>

    В качетве параметра Y взято количество байт передаваемоего трафика,
    а в качетве пареметров X и ЦВЕТА и ФОРМЫ представлена следующая
    функция на языке SQL:

    `IF`

    `(([src] LIKE '12.%' OR [src] LIKE '13.%' OR [src] LIKE '14.%') AND (NOT([dst] LIKE '12.%' OR [dst] LIKE '13.%' OR [dst] LIKE '14.%')))`

    `THEN "Исходящий трафик"`

    `ELSEIF (([dst] LIKE '12.%' OR [dst] LIKE '13.%' OR [dst] LIKE '14.%') AND (NOT([src] LIKE '12.%' OR [src] LIKE '13.%' OR [src] LIKE '14.%')))`

    `THEN "Входящий трафик"`

    `ELSE "Остальной трафик"`

    `END`

4.  Все построенные графики выведены в виде единого дашборда в Yandex
    DataLens.

      
    ![Дашборд - часть 1](images/Дашборд1.png)

<figure>
<img src="images/Дашборд2.png" alt="Дашборд - часть 2" />
<figcaption aria-hidden="true">Дашборд - часть 2</figcaption>
</figure>

## Оценка результата

Изучены возможности технологии Yandex Query для анализа
структурированных наборов данных и закреплены знания SQL-запросов для
анализа данных сетевой активности в сегментированной корпоративной сети.
А также, используя сервис Yandex DataLens, настроен доступ к  
Yandex Query, приведены аналитические отчеты данных сетевой активности в
сегментированной корпоративной сети.  

## Вывод

Yandex DataLens - сервис анализа и визуализации данных от Yandex Cloud.
Yandex DataLens имеет простой и понятный интерфейс, который позволяет
пользователям быстро начать работу с данными, предоставляет множество
функций для анализа данных, включая визуализацию, создание отчётов и
прогнозировани.
